---
title: "phyparts analyses"
output: github_document
date: 2024-7-12
---

```{julia}
using PhyloNetworks
genetrees = readMultiTopology("data/newgts/all_singlecopy_orthologs_gene_trees.tre");
sptree = readTopology("data/newgts/species_tree_newick.tre");

#filter Burmeistera from genetrees
tips = tipLabels(genetrees)
#use regex to get sample that start either "Bur_sp" or "Burmeistera_sp"
burmeistera = filter(contains(r"Bur_"), tips)
append!(burmeistera, filter(contains(r"Burmeistera_"), tips))
#let's remove the top 3 samples based on gt presence %
keepers = ["Burmeistera_brighamioides_2016_121", "Burmeistera_succulenta_2016_188", "Burmeistera_auriculata_2016_199"]
deleteat!(burmeistera, findall(x -> x in keepers, burmeistera))
#remove all Burmeistera except for 3 above
for gt in genetrees
    for tip in burmeistera
        try deleteleaf!(gt,tip) 
        catch e
        end
        deleteleaf!(sptree,tip)
    end
end
for tip in burmeistera
    deleteleaf!(sptree,tip)
end
#reroot 
rootatnode!(sptree, "LL350_L_tupa")

#write trees to file
writeMultiTopology(genetrees, "data/newgts/filteredgts.tre")
writeTopology(sptree, "data/newgts/filteredsptree.tre")
```

Problem: performance taking quite a long time. As of 7-12-24 11:40am, has been running for 67 hours,
which to my recollection seems quite long. I assume computational time grows exponential with number
of internal nodes, so perhaps if I delete all Burmeistera sp. from gene trees + reference species tree,
this will boost computational speed?

Could also remove some outgroups if necessary, as well.

Command for running on all gene trees which is taking quite a long time:
```{bash}
java -jar bin/phyparts/target/phyparts-0.0.1-SNAPSHOT-jar-with-dependencies.jar -a 1 -v -d data/newgts/all_singlecopy_orthologs_gene_trees.tre -m data/newgts/species_tree_newick.tre -o output/out
```

Command for running on pruned data set (removing 73/218 tips):

```{bash}
java -jar bin/phyparts/target/phyparts-0.0.1-SNAPSHOT-jar-with-dependencies.jar -a 1 -v -d data/newgts/filteredgts.tre -m data/newgts/filteredsptree.tre -o output/out
```